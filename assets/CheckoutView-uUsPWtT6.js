import{a as f,_ as T,j as I,o as r,c as i,b as t,w as k,v as x,t as u,m as A,s as N,f as l,g,d as h,J as B,i as p,e as c,F as U,r as L,n as v,N as j}from"./index-Ay6J1GsN.js";import{o as O}from"./ordersStore-hSB9EXBG.js";import{c as D}from"./cartsStore-G0JDtmNk.js";import{p as G}from"./pageStore-IIw7s-IT.js";import{C as Q}from"./ContactUsDetails-cDSU2tyO.js";import{B as E}from"./BasicCollapse-8vDuYkiU.js";import"./stringStore-DWxchtU1.js";import"./timeStore-OJZok87a.js";const F={data(){return{currentNum:1,currentQty:1}},props:["inventory","id","qty","productCartId"],emits:["putNum"],methods:{plusNum(){if(this.currentNum=parseInt(this.currentNum,10),this.currentNum>=1&&this.currentNum<this.inventory){this.currentNum+=1,this.$emit("putNum",this.productCartId,this.id,this.currentNum);return}this.currentNum>=this.inventory&&this.showAlertMessage(!1,"å¾ˆæŠ±æ­‰ï¼Œä¸èƒ½è¶…å‡ºæ­¤åº«å­˜é‡")},minusNum(){if(this.currentNum=parseInt(this.currentNum,10),this.currentNum>1){this.currentNum-=1,this.$emit("putNum",this.productCartId,this.id,this.currentNum);return}this.currentNum<=1&&this.showAlertMessage(!1,"å¾ˆæŠ±æ­‰ï¼Œæœ€ä½æ•¸é‡ç‚º1")},blurNum(e){if(this.currentNum=parseInt(e.target.value,10),this.currentNum>this.inventory){this.currentNum=this.inventory,this.$emit("putNum",this.productCartId,this.id,this.currentNum),this.showAlertMessage(!1,"å¾ˆæŠ±æ­‰ï¼Œä¸èƒ½è¶…å‡ºæ­¤åº«å­˜é‡");return}if(this.currentNum<=0){this.currentNum=1,this.$emit("putNum",this.productCartId,this.id,this.currentNum),this.showAlertMessage(!1,"å¾ˆæŠ±æ­‰ï¼Œæœ€ä½æ•¸é‡ç‚º1");return}if(this.currentNum!==this.currentQty){if(Number.isNaN(this.currentNum)){this.showAlertMessage(!1,"è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•¸å­—"),this.currentNum=this.currentQty;return}this.$emit("putNum",this.productCartId,this.id,this.currentNum)}},...f(I,["showAlertMessage"])},watch:{qty(e){this.currentNum=e,this.currentQty=e}},mounted(){this.qty>this.inventory&&this.$emit("putNum",this.productCartId,this.id,this.inventory),this.currentNum=this.qty,this.currentQty=this.qty}},J={class:""},R={class:"bg-white d-flex mb-3 border btns-max-width"},z=["disabled"],H=["disabled"],K={class:"d-flex align-items-end"};function W(e,s,b,_,a,n){return r(),i("div",J,[t("div",R,[t("button",{disabled:a.currentNum===1,type:"button",class:"btn",onClick:s[0]||(s[0]=(...m)=>n.minusNum&&n.minusNum(...m))},"-",8,z),k(t("input",{type:"number",class:"form-control border-white shadow-none text-center fw-bold","onUpdate:modelValue":s[1]||(s[1]=m=>a.currentNum=m),onBlur:s[2]||(s[2]=(...m)=>n.blurNum&&n.blurNum(...m))},null,544),[[x,a.currentNum,void 0,{number:!0}]]),t("button",{disabled:a.currentNum===b.inventory,type:"button",class:"btn",onClick:s[3]||(s[3]=(...m)=>n.plusNum&&n.plusNum(...m))}," + ",8,H)]),t("p",K,"ç›®å‰åº«å­˜ï¼š"+u(b.inventory),1)])}const X=T(F,[["render",W],["__scopeId","data-v-ece9a255"]]),Y={data(){return{useCoupon:!1,couponCode:"",checkOrderInfo:!1,orderData:{data:{user:{name:null,email:null,tel:null,address:null},message:null}},doesPostCart:!1}},components:{QuantityControlButtons:X,ContactUsDetails:Q,BasicCollapse:E},methods:{isPhone(e){return/^(09)[0-9]{8}$/.test(e)?!0:"è«‹è¼¸å…¥æ­£ç¢ºçš„è¡Œå‹•é›»è©±è™Ÿç¢¼"},changeToProductPage(e,s){this.changeNowPage(s),this.$router.push({name:"product",params:{id:e}})},async goToGetCart(e=!0){try{await this.getCart(e)}catch(s){this.showAlertMessage(!1,s.response.data.message)}},async goToPutCart(e,s,b){try{const _=await this.putCart(e,s,b);await this.goToGetCart(!1),this.pushToast({title:_.data.message,style:"bg-deep-gray"})}catch(_){this.showAlertMessage(!1,_.response.data.message)}},async goToDeleteCart(e){try{const s=await this.deleteCart(e);await this.goToGetCart(!1),this.pushToast({title:s.data.message,style:"bg-deep-gray"})}catch(s){this.showAlertMessage(!1,s.response.data.message)}},async goToDeleteCarts(){try{const e=await this.deleteCarts();await this.goToGetCart(),this.pushToast({title:e.data.message,style:"bg-deep-gray"})}catch(e){this.showAlertMessage(!1,e.response.data.message)}},async goToPostCoupon(){try{const e=await this.postCoupon(this.couponCode);await this.goToGetCart(!1),this.pushToast({title:e.data.message,style:"bg-deep-gray"})}catch(e){this.showAlertMessage(!1,e.response.data.message)}},async goToPostOrder(){this.doesPostCart=!0;try{const e=await this.postOrder(this.orderData);this.$router.push({name:"payment",params:{id:e.data.orderId}}),this.$nextTick(()=>{this.goToGetCart(!1),this.$refs.form.resetForm()})}catch(e){this.showAlertMessage(!1,e.response.data.message)}},...f(D,["getCart","putCart","deleteCart","deleteCarts","postCoupon"]),...f(O,["postOrder"]),...f(B,["pushToast"]),...f(G,["changeNowPage"]),...f(I,["showAlertMessage"])},computed:{...A(D,["isLoading","isSmLoading","cartsData","allCartsData"])},mounted(){if(this.goToGetCart(),window.sessionStorage.getItem("orderData")){const e=window.sessionStorage.getItem("orderData");this.orderData=JSON.parse(e)}},beforeUnmount(){if(this.doesPostCart)window.sessionStorage.removeItem("orderData");else{const e=JSON.stringify(this.orderData);window.sessionStorage.setItem("orderData",e)}}},Z={key:1,class:"container bg-main-medium container-rounded my-5 py-7r px-lg-5 px-md-4 px-sm-3"},$=t("div",{class:"d-flex align-items-center justify-content-center mb-3"},[t("h2",{class:"text-center border-secondary pb-2 fw-bold"},"çµå¸³")],-1),tt={class:"row row-cols-1 row-cols-lg-2"},et={class:"col"},st={class:"accordion"},ot={key:0,class:""},at=t("p",null,"ç›®å‰è³¼ç‰©è»Šå…§æ²’æœ‰ç”¢å“ ğŸ˜„",-1),rt={key:1,class:""},nt={class:"col col-sm-2 col-lg-3 d-flex align-items-center justify-content-center"},lt=["onClick","src","alt"],it={class:"col col-sm-10 col-lg-9"},dt={class:"d-flex justify-content-between"},ut=["onClick"],ct=["onClick"],mt={key:0},ht={key:0,class:"d-flex mb-3"},pt={class:"d-flex justify-content-between"},gt=t("p",null,"ç”¢å“ç¸½é‡‘é¡",-1),ft=t("div",{class:"d-flex justify-content-between"},[t("p",null,"é‹è²»"),t("p",null,"å…é‹è²»")],-1),bt={key:0},_t={key:0,class:"d-flex justify-content-between"},yt=t("p",null,"å„ªæƒ ä»£ç¢¼",-1),Ct={key:1,class:"mb-3"},vt=t("p",{class:"w-25"},"å„ªæƒ ä»£ç¢¼",-1),Nt={class:"d-flex justify-content-between align-items-center"},wt={key:1,class:"d-flex justify-content-between"},kt=t("p",null,"ä½¿ç”¨å„ªæƒ åˆ¸",-1),Dt=t("hr",null,null,-1),Tt={key:2,class:"d-flex justify-content-between"},It=t("p",null,"ç¸½ä»˜æ¬¾é‡‘é¡",-1),xt={class:"text-end"},Vt={key:3,class:""},Pt={class:"d-flex justify-content-between"},St=t("p",null,"ç¸½ä»˜æ¬¾é‡‘é¡",-1),Mt={class:"text-decoration-line-through"},qt={class:"text-end"},At={class:"col"},Bt={class:"accordion"},Ut={class:"mb-3"},Lt=t("label",{for:"user",class:"form-label"},[c("æ”¶ä»¶äººåç¨± "),t("span",{class:"text-main-spec fw-bold"},"*")],-1),jt={class:"mb-3"},Ot=t("label",{for:"email",class:"form-label"},[c("é›»å­ä¿¡ç®± "),t("span",{class:"text-main-spec fw-bold"},"*")],-1),Gt={class:"mb-3"},Qt=t("label",{for:"phone",class:"form-label"},[c("è¡Œå‹•é›»è©±è™Ÿç¢¼ "),t("span",{class:"text-main-spec fw-bold"},"*")],-1),Et={class:"mb-3"},Ft=t("label",{for:"address",class:"form-label"},[c("æ”¶ä»¶åœ°å€ "),t("span",{class:"text-main-spec fw-bold"},"*")],-1),Jt={class:"mb-3"},Rt=t("label",{for:"orderMessage",class:"form-label"},"è¨‚å–®å‚™è¨»",-1),zt={class:"form-check mb-3"},Ht=t("label",{for:"is_enabled",class:"form-check-label"},[t("span",{class:"text-main-spec fw-bold"},"æˆ‘å·²ç¢ºèªä»¥ä¸‹å…§å®¹ï¼š"),t("span",null,[t("br"),c("æé†’æ‚¨ï¼Œé€å‡ºè¨‚å–®å¾Œï¼Œå°‡ç„¡æ³•ä¿®æ”¹è¨‚å–®å…§å®¹ï¼Œä¸¦å‰å¾€ä»˜æ¬¾æµç¨‹ï¼Œè«‹æ‚¨ç¢ºå®šç„¡èª¤å¾Œå†é€å‡ºğŸ˜„")])],-1),Kt=t("div",{class:"bg-light-gray text-deep-gray px-3 py-2 mb-3"},[t("h6",null,"å…é‹æœå‹™"),t("span",null,"æˆ‘å€‘çš„ç”¢å“ä»˜æ¬¾æ¡ç”¨ã€Œç·šä¸Šä¿¡ç”¨å¡ã€ä»˜æ¬¾å¾Œå‡ºè²¨ï¼Œé‹é€æ¡ç”¨ã€Œå®…é…åˆ°åºœã€å…é‹æœå‹™ï¼Œè®“æ‚¨è¼•é¬†è³¼è²·ã€å®‰å¿ƒæ”¶è²¨ã€‚")],-1),Wt={class:"d-flex mb-3"},Xt=["disabled"];function Yt(e,s,b,_,a,n){const m=p("PageLoading"),V=p("RouterLink"),P=p("VueLoading"),S=p("QuantityControlButtons"),w=p("BasicCollapse"),M=p("ContactUsDetails"),y=p("vee-field"),C=p("vee-error-message"),q=p("vee-form");return r(),i("div",null,[e.isLoading?(r(),N(m,{key:0})):(r(),i("div",Z,[$,t("div",tt,[t("div",et,[t("div",st,[l(w,{uniqueId:"ShoppingCartSection",open:!0},{header:g(()=>[c(" è³¼ç‰©è»Š ")]),body:g(()=>[e.cartsData.length===0?(r(),i("div",ot,[at,l(V,{to:{name:"products",query:{category:"å…¨éƒ¨ç”¢å“"}},class:"btn btn-solid-spec w-100 btn-lg"},{default:g(()=>[c(" ç¹¼çºŒè³¼ç‰© ")]),_:1})])):(r(),i("div",rt,[(r(!0),i(U,null,L(e.cartsData,o=>(r(),i("div",{class:"row mb-3 position-relative",key:o.id},[l(P,{active:o.product.id===e.isSmLoading||o.id===e.isSmLoading,"is-full-page":!1,color:"#52504B"},null,8,["active"]),t("div",nt,[t("img",{role:"button",onClick:d=>n.changeToProductPage(o.product.id,o.product.category),src:o.product.imageUrl,alt:o.product.title,class:"img-fluid",width:"150"},null,8,lt)]),t("div",it,[t("div",dt,[t("h6",{class:"text-link-deep-gray",role:"button",onClick:d=>n.changeToProductPage(o.product.id,o.product.category)},u(o.product.title),9,ut),t("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:d=>n.goToDeleteCart(o.id)},null,8,ct)]),t("p",null,[c(" å–®åƒ¹NT$ "+u(parseInt(o.product.price))+" / å°è¨ˆNT$ "+u(parseInt(o.total))+" ",1),o.final_total!==o.total?(r(),i("span",mt," /å„ªæƒ åƒ¹NT$ "+u(parseInt(o.final_total)),1)):h("",!0)]),l(S,{inventory:o.product.inventory,id:o.product_id,qty:o.qty,"product-cart-id":o.id,onPutNum:n.goToPutCart},null,8,["inventory","id","qty","product-cart-id","onPutNum"])])]))),128)),e.cartsData.length>1?(r(),i("div",ht,[t("button",{type:"button",class:"btn btn-outline-mdgray w-100",onClick:s[0]||(s[0]=(...o)=>n.goToDeleteCarts&&n.goToDeleteCarts(...o))}," æ¸…ç©ºè³¼ç‰©è»Š ")])):h("",!0)]))]),_:1}),e.cartsData.length!==0?(r(),N(w,{key:0,uniqueId:"OrderConfirmationSection",open:!0},{header:g(()=>[c(" è¨‚å–®ç¢ºèª ")]),body:g(()=>[t("div",pt,[gt,t("p",null,"NT$ "+u(parseInt(e.allCartsData.total)),1)]),ft,e.allCartsData.useCoupon?h("",!0):(r(),i("div",bt,[a.useCoupon?a.useCoupon?(r(),i("div",Ct,[vt,t("div",Nt,[k(t("input",{type:"text",class:"form-control",id:"category",placeholder:"è«‹å¡«å…¥å„ªæƒ ä»£ç¢¼","onUpdate:modelValue":s[2]||(s[2]=o=>a.couponCode=o)},null,512),[[x,a.couponCode]]),t("button",{type:"button",class:"w-25 btn btn-outline-dpgray ms-3",onClick:s[3]||(s[3]=(...o)=>n.goToPostCoupon&&n.goToPostCoupon(...o))}," ä½¿ç”¨ "),t("button",{type:"button",class:"w-25 btn btn-outline-dpgray ms-3",onClick:s[4]||(s[4]=o=>a.useCoupon=!1)}," å–æ¶ˆ ")])])):h("",!0):(r(),i("div",_t,[yt,t("button",{type:"button",class:"btn btn-outline-dpgray",onClick:s[1]||(s[1]=o=>a.useCoupon=!0)}," ä½¿ç”¨å„ªæƒ ä»£ç¢¼ ")]))])),e.allCartsData.useCoupon?(r(),i("div",wt,[kt,t("p",null," å„ªæƒ  NT$ "+u(parseInt(e.allCartsData.total,10)-parseInt(e.allCartsData.final_total,10)),1)])):h("",!0),Dt,e.allCartsData.useCoupon?e.allCartsData.useCoupon?(r(),i("div",Vt,[t("div",Pt,[St,t("h5",Mt," NT$ "+u(parseInt(e.allCartsData.total)),1)]),t("h4",qt,"NT$ "+u(parseInt(e.allCartsData.final_total)),1)])):h("",!0):(r(),i("div",Tt,[It,t("h4",xt,"NT$ "+u(parseInt(e.allCartsData.total)),1)]))]),_:1})):h("",!0)])]),t("div",At,[t("div",Bt,[e.cartsData.length===0?(r(),N(M,{key:0})):h("",!0),e.cartsData.length!==0?(r(),N(w,{key:1,uniqueId:"RecipientInformationSection",open:!0},{header:g(()=>[c(" æ”¶ä»¶è³‡æ–™ ")]),body:g(()=>[l(q,{ref:"form",onSubmit:n.goToPostOrder},{default:g(({errors:o})=>[t("div",Ut,[Lt,l(y,{type:"text",name:"æ”¶ä»¶äºº",class:v(["form-control",{"is-invalid":o.æ”¶ä»¶äºº}]),rules:"required|max:15",id:"user",placeholder:"è«‹å¡«å…¥æ”¶ä»¶äººçœŸå¯¦å§“åï¼Œä»¥ç¢ºä¿é †åˆ©æ”¶ä»¶",modelValue:a.orderData.data.user.name,"onUpdate:modelValue":s[5]||(s[5]=d=>a.orderData.data.user.name=d)},null,8,["class","modelValue"]),l(C,{class:"invalid-feedback",name:"æ”¶ä»¶äºº"})]),t("div",jt,[Ot,l(y,{type:"email",class:v(["form-control",{"is-invalid":o.é›»å­ä¿¡ç®±}]),id:"email",rules:"email|required",name:"é›»å­ä¿¡ç®±",placeholder:"è«‹å¡«å…¥è¨‚å–®é€šçŸ¥Email (è¨‚å–®è³‡è¨Šå°‡ä»¥æ­¤E-mailé€šçŸ¥æ‚¨)",modelValue:a.orderData.data.user.email,"onUpdate:modelValue":s[6]||(s[6]=d=>a.orderData.data.user.email=d)},null,8,["class","modelValue"]),l(C,{class:"invalid-feedback",name:"é›»å­ä¿¡ç®±"})]),t("div",Gt,[Qt,l(y,{type:"tel",name:"è¡Œå‹•é›»è©±",rules:n.isPhone,class:v(["form-control",{"is-invalid":o.è¡Œå‹•é›»è©±}]),id:"phone",placeholder:"è«‹å¡«å…¥æ”¶ä»¶äººè¡Œå‹•é›»è©±è™Ÿç¢¼ (ä¾›é…é€äººå“¡è¯çµ¡)",modelValue:a.orderData.data.user.tel,"onUpdate:modelValue":s[7]||(s[7]=d=>a.orderData.data.user.tel=d)},null,8,["rules","class","modelValue"]),l(C,{class:"invalid-feedback",name:"è¡Œå‹•é›»è©±"})]),t("div",Et,[Ft,l(y,{type:"text",name:"æ”¶ä»¶åœ°å€",class:v(["form-control",{"is-invalid":o.æ”¶ä»¶åœ°å€}]),id:"address",rules:"required|max:100",placeholder:"é€è²¨åœ°é»ç›®å‰åƒ…æä¾›ï¼šå°ç£ã€å°ç£å¤–å³¶å®…é…",modelValue:a.orderData.data.user.address,"onUpdate:modelValue":s[8]||(s[8]=d=>a.orderData.data.user.address=d)},null,8,["class","modelValue"]),l(C,{class:"invalid-feedback",name:"æ”¶ä»¶åœ°å€"})]),t("div",Jt,[Rt,l(y,{as:"textarea",name:"è¨‚å–®å‚™è¨»",class:v(["w-100 form-control",{"is-invalid":o.è¨‚å–®å‚™è¨»}]),id:"orderMessage",rows:"5",placeholder:"ç®¡ç†å®¤ä»£æ”¶/é›»è©±è¯çµ¡æ™‚é–“...",rules:"max:800",modelValue:a.orderData.data.message,"onUpdate:modelValue":s[9]||(s[9]=d=>a.orderData.data.message=d)},null,8,["class","modelValue"]),l(C,{class:"invalid-feedback",name:"è¨‚å–®å‚™è¨»"})]),t("div",zt,[k(t("input",{type:"checkbox",class:"form-check-input",id:"is_enabled","onUpdate:modelValue":s[10]||(s[10]=d=>a.checkOrderInfo=d)},null,512),[[j,a.checkOrderInfo]]),Ht]),Kt,t("div",Wt,[t("button",{type:"submit",class:"border btn btn-solid-spec w-100 btn-lg",disabled:!a.checkOrderInfo}," çµå¸³ ",8,Xt)])]),_:1},8,["onSubmit"])]),_:1})):h("",!0)])])])]))])}const ne=T(Y,[["render",Yt]]);export{ne as default};
